# config/global_validation_rules.yaml

# 定义一个或多个校验规则集
rulesets:
  # 规则集名称，可以是任意字符串，用于标识和引用
  default_emotion_annotation:
    # 描述此规则集的用途
    description: "默认的情感标注校验规则"
    # 定义数组中每个元素（字典）的校验规则
    item_schema:
      # 字段 'id' 的规则
      id:
        type: "string"       # 期望的数据类型
        required: true       # 是否为必需字段

      # 字段 'primary' 的规则
      primary:
        type: "string"
        required: true

      # 字段 'secondary' 的规则
      secondary:
        type: "array"        # 期望的数据类型为数组
        required: true
        # 可以定义数组元素的类型
        items:
          type: "string"     # 数组中每个元素都应为字符串

  # 为适配"交际诗分析框架"而设计的规则集
  social_poetry_analysis:
    description: "适配 config/system_prompt_instruction - 副本.txt 定义的交际诗分析输出格式"
    item_schema:
      # 字段 'id' 的规则 (必需, 字符串)
      id:
        type: "string"
        required: true

      # 字段 'relationship_action' 的规则 (必需, 字符串, RAxx格式)
      relationship_action:
        type: "string"
        required: true
        # 可以添加模式匹配约束 (例如, 以RA开头)
        # pattern: "^RA\d{2}$"

      # 字段 'emotional_strategy' 的规则 (必需, 字符串, ESxx格式)
      emotional_strategy:
        type: "string"
        required: true
        # pattern: "^ES\d{2}$"

      # 字段 'context_analysis' 的规则 (必需, 对象)
      context_analysis:
        type: "object"
        required: true
        # 定义嵌套对象 'context_analysis' 的结构
        properties:
          # 子字段 'communication_scene' (必需, 数组)
          communication_scene:
            type: "array"
            required: true
            # 数组元素类型 (字符串, SCxx格式)
            items:
              type: "string"
              # pattern: "^SC\d{2}$"

          # 子字段 'risk_level' (必需, 字符串, RSxx格式)
          risk_level:
            type: "string"
            required: true
            # pattern: "^RS\d{2}$"

      # 字段 'brief_rationale' 的规则 (必需, 字符串, 长度限制)
      brief_rationale:
        type: "string"
        required: true
        # 添加长度约束
        max_length: 25

  # 另一个示例规则集，用于更复杂的场景
  extended_emotion_annotation:
    description: "扩展的情感标注校验规则，包含更多字段"
    item_schema:
      id:
        type: "string"
        required: true
      primary:
        type: "string"
        required: true
      secondary:
        type: "array"
        required: true
        items:
          type: "string"
      # 新增字段 'confidence'
      confidence:
        type: "number"       # 期望为数值类型 (int 或 float)
        required: false      # 非必需字段
        # 可以添加范围约束
        minimum: 0.0
        maximum: 1.0

      # 新增字段 'reasoning'
      reasoning:
        type: "string"
        required: false

# 全局配置
global:
  # 指定当前激活的规则集名称
  active_ruleset: "default_emotion_annotation"