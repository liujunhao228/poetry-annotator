# GUI 启动器详细说明

## 简介

`gui_launcher.py` 是一个图形用户界面启动器，基于 Tkinter 开发，为诗词情感标注项目提供可视化的操作界面。它集成了多个核心脚本的功能，使用户可以通过直观的图形界面来执行任务分发、随机抽样、日志恢复等操作，而无需直接使用命令行。

## 功能特性

- **可视化操作界面**：提供直观的图形界面，用户可通过点击按钮、选择选项等方式操作
- **多任务集成**：集成了任务分发、随机抽样、日志恢复等核心功能
- **实时日志显示**：在操作过程中实时显示日志输出，便于监控任务执行状态
- **参数配置**：通过界面控件设置各种参数，避免复杂的命令行参数输入
- **任务控制**：支持开始和停止任务操作
- **配置保存**：自动保存用户界面配置，下次启动时恢复上次设置

## 使用方法

在项目根目录下运行以下命令启动 GUI：

```bash
python scripts/gui_launcher.py
```

## 界面说明

GUI 主界面采用选项卡式设计，包含以下功能模块：

### 1. 任务分发 (Distribution)
用于分发诗词情感标注任务，提供与 `distribute_tasks.py` 脚本相同的功能。

**主要功能：**
- 模型选择（单个模型或所有模型）
- ID 来源选择（单个文件或目录）
- 日志级别控制（控制台和文件）
- 数据库选择
- 批次大小设置
- 强制重跑和全新开始选项

### 2. 随机抽样 (Sampling)
用于随机抽取诗词 ID，提供与 `random_sample.py` 脚本相同的功能。

**主要功能：**
- 抽样数量设置
- 数据库选择
- 过滤选项（过滤缺字标记、排除已标注诗词）
- 排序方式选择（随机、升序、不排序）
- 输出设置（单文件或目录分段输出）

### 3. 日志恢复 (Recovery)
用于从日志文件中恢复因意外中断而未保存的标注数据，基于 `recover_from_log_v7.py` 脚本功能。

**主要功能：**
- 日志文件/目录选择
- 数据库路径设置
- 试运行模式（Dry Run）
- 实际写入数据库操作

## 技术实现

### 架构设计
GUI 采用模块化设计，每个功能选项卡都是一个独立的类，继承自 `TaskExecutorTab` 基类。基类提供了通用的任务执行逻辑，包括子进程管理、日志输出处理等。

### 核心组件
- `TaskExecutorTab`：抽象基类，提供通用任务执行逻辑
- `DistributionTab`：任务分发功能界面
- `SamplingTab`：随机抽样功能界面
- `RecoveryTab`：日志恢复功能界面
- `PoetryToolGUI`：主应用程序窗口

### 关键技术点
1. **多线程处理**：使用 `threading` 模块在后台执行脚本，避免界面冻结
2. **子进程管理**：通过 `subprocess` 模块调用 Python 脚本
3. **队列通信**：使用 `queue.Queue` 在线程间传递日志信息
4. **配置持久化**：使用 JSON 文件保存界面配置
5. **编码处理**：正确处理中文字符编码，确保在不同平台上正常显示

## 注意事项

1. 运行 GUI 前请确保已正确配置项目环境和数据库连接
2. 部分功能需要特定的配置文件支持
3. 建议在执行重要操作前先了解各参数的含义
4. 对于涉及数据库写入的操作，请特别小心，建议先备份数据库
5. 如遇到中文显示问题，请检查系统字体设置和编码配置
